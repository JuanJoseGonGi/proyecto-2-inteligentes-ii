\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{physics}
\usepackage{subcaption}
\usepackage{float}
\usepackage{pgffor}

\title{Aproximación de la Ecuación de Movimiento de un Péndulo Simple utilizando Redes Neuronales}
\author{Juan José González \\ Juan Camilo Ramírez \\ Juan David Osorio}
\date{Junio 2024}

\begin{document}

\maketitle

\begin{abstract}
    Este informe presenta el proceso y los resultados del Proyecto II del curso de Sistemas Inteligentes II, cuyo objetivo fue entrenar y comparar diferentes modelos DQN (Deep Q-Network) para resolver los problemas de control clásicos en el entorno OpenAI Gym CartPole y MountainCar. Se experimentó con diversas configuraciones de hiperparámetros para evaluar su impacto en el rendimiento del modelo.
\end{abstract}

\section{Introducción}
El control de sistemas dinámicos es un área crucial en la inteligencia artificial y la robótica. Este proyecto se centra en el uso del algoritmo DQN para resolver problemas de control en entornos simulados proporcionados por OpenAI Gym. El objetivo es entrenar y comparar diferentes configuraciones de modelos DQN para evaluar su eficacia en los entornos CartPole y MountainCar.

\section{Metodología}
\subsection{Configuración del entorno OpenAI Gym}
Se utilizaron los entornos CartPole y MountainCar de OpenAI Gym para entrenar los modelos DQN. Estos entornos proporcionan desafíos clásicos de control que son ampliamente utilizados para evaluar algoritmos de aprendizaje por refuerzo.

\subsection{Arquitectura del modelo DQN}
El mejor modelo DQN para MountainCar con 2 capas con 64 neuronas y una función de activación ReLU. La capa de salida es una función de activación lineal.

\subsection{Hiperparámetros utilizados}
Los hiperparámetros clave que se experimentaron incluyen la tasa de aprendizaje, el tamaño del batch, el factor de descuento (gamma), la tasa de exploración-explotación (epsilon), el número de épocas, el número de capas y el número de neuronas en cada capa. En el caso específico de MountainCar se añadió un hiperparámetro para controlar el peso que tiene la velocidad en la recompensa.

\subsection{Estrategia de entrenamiento}
Los modelos se entrenaron utilizando la técnica de aprendizaje por refuerzo con experiencia de repetición, donde se almacenan transiciones en un buffer de experiencia y se realizan actualizaciones periódicas de la red objetivo. Además se utilizó la política de epsilon-greedy para controlar la exploración del modelo.

\section{Resultados}
Los modelos finales muestran una buena capacidad de acción y precisión en los entornos de control de OpenAI Gym. Se evaluaron las recompensas promedio y la tasa de éxito en cada entorno. Los resultados se presentan en forma de gráficos y tablas comparativas.
\subsection{Mountain}
\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                                  & evaluate\_max\_reward & evaluate\_rewards\_mean & evaluate\_rewards\_std \\
            2024-06-15\_12-31-16\_dqn\_mountaincar & -87.0                 & -109.1                  & 20.34                  \\
            2024-06-15\_13-02-52\_dqn\_mountaincar & -86.0                 & -112.9                  & 22.10                  \\
            2024-06-15\_13-39-22\_dqn\_mountaincar & -146.0                & -150.3                  & 2.96                   \\
            2024-06-15\_13-45-28\_dqn\_mountaincar & -116.0                & -183.5                  & 33.01                  \\
            2024-06-15\_12-43-21\_dqn\_mountaincar & -84.0                 & -121.7                  & 23.66                  \\
            2024-06-15\_13-00-05\_dqn\_mountaincar & -85.0                 & -115.1                  & 26.20                  \\
            2024-06-15\_08-13-32\_dqn\_mountaincar & -200.0                & -200.0                  & 0.00                   \\
            2024-06-15\_13-20-27\_dqn\_mountaincar & -140.0                & -147.8                  & 8.68                   \\
            2024-06-15\_10-54-10\_dqn\_mountaincar & -108.0                & -141.2                  & 11.74                  \\
            2024-06-15\_13-41-53\_dqn\_mountaincar & -92.0                 & -130.9                  & 23.40                  \\
            2024-06-15\_12-23-27\_dqn\_mountaincar & -87.0                 & -126.7                  & 23.06                  \\
            2024-06-15\_11-21-25\_dqn\_mountaincar & -110.0                & -137.7                  & 19.36                  \\
            2024-06-15\_13-45-47\_dqn\_mountaincar & -96.0                 & -134.2                  & 24.63                  \\
            2024-06-15\_11-01-53\_dqn\_mountaincar & -85.0                 & -109.1                  & 20.54                  \\
            2024-06-15\_12-35-51\_dqn\_mountaincar & -89.0                 & -127.1                  & 22.23                  \\
            2024-06-15\_16-46-16\_dqn\_mountaincar & -111.0                & -128.5                  & 14.23                  \\
            2024-06-15\_12-16-56\_dqn\_mountaincar & -108.0                & -126.6                  & 17.48                  \\
            2024-06-15\_13-48-51\_dqn\_mountaincar & -93.0                 & -113.8                  & 14.22                  \\
            2024-06-15\_12-43-26\_dqn\_mountaincar & -144.0                & -154.9                  & 17.40                  \\
            2024-06-15\_13-36-42\_dqn\_mountaincar & -84.0                 & -104.4                  & 18.46                  \\
            2024-06-15\_11-57-24\_dqn\_mountaincar & -118.0                & -136.7                  & 16.19                  \\
            2024-06-15\_13-56-21\_dqn\_mountaincar & -85.0                 & -114.8                  & 26.32                  \\
        \end{tabular}
    }
\end{center}

\begin {center}
\resizebox{\textwidth}{!} {
    \begin{tabular}{lllll}
        model                                  & hidden\_layers & units\_per\_layer & activation\_per\_layer & output\_layer\_activation \\
        2024-06-15\_12-31-16\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-02-52\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-39-22\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-45-28\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_12-43-21\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-00-05\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_08-13-32\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-20-27\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_10-54-10\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-41-53\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_12-23-27\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_11-21-25\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-45-47\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_11-01-53\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_12-35-51\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_16-46-16\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_12-16-56\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-48-51\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_12-43-26\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-36-42\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_11-57-24\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
        2024-06-15\_13-56-21\_dqn\_mountaincar & 2              & {[}64, 64{]}      & {[}'relu', 'relu'{]}   & linear                    \\
    \end{tabular}
}
\end{center}

\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                                  & num\_episodes & learning\_rate & epsilon               \\
            2024-06-15\_12-31-16\_dqn\_mountaincar & 500           & 0.005          & 0.6063789448611848    \\
            2024-06-15\_13-02-52\_dqn\_mountaincar & 500           & 0.001          & 0.0009550049507968265 \\
            2024-06-15\_13-39-22\_dqn\_mountaincar & 200           & 0.0001         & 0.0009833015279105794 \\
            2024-06-15\_13-45-28\_dqn\_mountaincar & 200           & 0.01           & 0.13397967485796175   \\
            2024-06-15\_12-43-21\_dqn\_mountaincar & 500           & 0.001          & 0.07341467529625044   \\
            2024-06-15\_13-00-05\_dqn\_mountaincar & 500           & 0.001          & 0.07341467529625044   \\
            2024-06-15\_08-13-32\_dqn\_mountaincar & 500           & 0.005          & 0.6063789448611848    \\
            2024-06-15\_13-20-27\_dqn\_mountaincar & 500           & 0.01           & 0.006570483042414605  \\
            2024-06-15\_10-54-10\_dqn\_mountaincar & 1000          & 0.005          & 0.3676954247709635    \\
            2024-06-15\_13-41-53\_dqn\_mountaincar & 200           & 0.005          & 0.0009833015279105794 \\
            2024-06-15\_12-23-27\_dqn\_mountaincar & 1000          & 0.005          & 0.000993147795920851  \\
            2024-06-15\_11-21-25\_dqn\_mountaincar & 1000          & 0.005          & 0.3676954247709635    \\
            2024-06-15\_13-45-47\_dqn\_mountaincar & 200           & 0.005          & 0.0009833015279105794 \\
            2024-06-15\_11-01-53\_dqn\_mountaincar & 1000          & 0.005          & 0.9048328935585562    \\
            2024-06-15\_12-35-51\_dqn\_mountaincar & 500           & 0.001          & 0.006570483042414605  \\
            2024-06-15\_16-46-16\_dqn\_mountaincar & 200           & 0.001          & 0.13397967485796175   \\
            2024-06-15\_12-16-56\_dqn\_mountaincar & 10000         & 0.005          & 0.3678610464329692    \\
            2024-06-15\_13-48-51\_dqn\_mountaincar & 200           & 0.001          & 0.13397967485796175   \\
            2024-06-15\_12-43-26\_dqn\_mountaincar & 1000          & 0.01           & 0.3676954247709635    \\
            2024-06-15\_13-36-42\_dqn\_mountaincar & 200           & 0.001          & 0.0009833015279105794 \\
            2024-06-15\_11-57-24\_dqn\_mountaincar & 1000          & 0.01           & 0.3676954247709635    \\
            2024-06-15\_13-56-21\_dqn\_mountaincar & 1000          & 0.001          & 0.000993147795920851  \\
        \end{tabular}
    }
\end{center}

\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llllllllll}
            model                                  & epsilon\_min & epsilon\_decay & batch\_size \\
            2024-06-15\_12-31-16\_dqn\_mountaincar & 0.001        & 0.999          & 128         \\
            2024-06-15\_13-02-52\_dqn\_mountaincar & 0.001        & 0.9            & 64          \\
            2024-06-15\_13-39-22\_dqn\_mountaincar & 0.001        & 0.95           & 64          \\
            2024-06-15\_13-45-28\_dqn\_mountaincar & 0.001        & 0.99           & 32          \\
            2024-06-15\_12-43-21\_dqn\_mountaincar & 0.001        & 0.995          & 256         \\
            2024-06-15\_13-00-05\_dqn\_mountaincar & 0.001        & 0.995          & 256         \\
            2024-06-15\_08-13-32\_dqn\_mountaincar & 0.005        & 0.999          & 256         \\
            2024-06-15\_13-20-27\_dqn\_mountaincar & 0.001        & 0.99           & 256         \\
            2024-06-15\_10-54-10\_dqn\_mountaincar & 0.001        & 0.999          & 128         \\
            2024-06-15\_13-41-53\_dqn\_mountaincar & 0.001        & 0.95           & 64          \\
            2024-06-15\_12-23-27\_dqn\_mountaincar & 0.001        & 0.99           & 128         \\
            2024-06-15\_11-21-25\_dqn\_mountaincar & 0.001        & 0.999          & 128         \\
            2024-06-15\_13-45-47\_dqn\_mountaincar & 0.001        & 0.95           & 64          \\
            2024-06-15\_11-01-53\_dqn\_mountaincar & 0.001        & 0.9999         & 128         \\
            2024-06-15\_12-35-51\_dqn\_mountaincar & 0.001        & 0.99           & 128         \\
            2024-06-15\_16-46-16\_dqn\_mountaincar & 0.001        & 0.99           & 32          \\
            2024-06-15\_12-16-56\_dqn\_mountaincar & 0.001        & 0.9999         & 128         \\
            2024-06-15\_13-48-51\_dqn\_mountaincar & 0.001        & 0.99           & 512         \\
            2024-06-15\_12-43-26\_dqn\_mountaincar & 0.001        & 0.999          & 128         \\
            2024-06-15\_13-36-42\_dqn\_mountaincar & 0.001        & 0.95           & 64          \\
            2024-06-15\_11-57-24\_dqn\_mountaincar & 0.001        & 0.999          & 128         \\
            2024-06-15\_13-56-21\_dqn\_mountaincar & 0.001        & 0.99           & 512         \\
        \end{tabular}
    }
\end{center}

\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                                  & discount & update\_target\_every & speed\_weight \\
            2024-06-15\_12-31-16\_dqn\_mountaincar & 0.9      & 40                    & 100.0         \\
            2024-06-15\_13-02-52\_dqn\_mountaincar & 0.9      & 20                    & 50.0          \\
            2024-06-15\_13-39-22\_dqn\_mountaincar & 0.9      & 20                    & 20.0          \\
            2024-06-15\_13-45-28\_dqn\_mountaincar & 0.9      & 10                    & 20.0          \\
            2024-06-15\_12-43-21\_dqn\_mountaincar & 0.9      & 20                    & 50.0          \\
            2024-06-15\_13-00-05\_dqn\_mountaincar & 0.9      & 20                    & 10.0          \\
            2024-06-15\_08-13-32\_dqn\_mountaincar & 0.95     & 40                    &               \\
            2024-06-15\_13-20-27\_dqn\_mountaincar & 0.9      & 20                    & 100.0         \\
            2024-06-15\_10-54-10\_dqn\_mountaincar & 0.9      & 40                    & 1000.0        \\
            2024-06-15\_13-41-53\_dqn\_mountaincar & 0.9      & 20                    & 20.0          \\
            2024-06-15\_12-23-27\_dqn\_mountaincar & 0.9      & 40                    & 100.0         \\
            2024-06-15\_11-21-25\_dqn\_mountaincar & 0.9      & 40                    & 100.0         \\
            2024-06-15\_13-45-47\_dqn\_mountaincar & 0.9      & 20                    & 20.0          \\
            2024-06-15\_11-01-53\_dqn\_mountaincar & 0.9      & 40                    & 1000.0        \\
            2024-06-15\_12-35-51\_dqn\_mountaincar & 0.9      & 40                    & 100.0         \\
            2024-06-15\_16-46-16\_dqn\_mountaincar & 0.9      & 10                    & 100.0         \\
            2024-06-15\_12-16-56\_dqn\_mountaincar & 0.9      & 40                    & 1000.0        \\
            2024-06-15\_13-48-51\_dqn\_mountaincar & 0.7      & 40                    & 100.0         \\
            2024-06-15\_12-43-26\_dqn\_mountaincar & 0.9      & 40                    & 100.0         \\
            2024-06-15\_13-36-42\_dqn\_mountaincar & 0.9      & 20                    & 20.0          \\
            2024-06-15\_11-57-24\_dqn\_mountaincar & 0.9      & 40                    & 100.0         \\
            2024-06-15\_13-56-21\_dqn\_mountaincar & 0.7      & 40                    & 100.0
        \end{tabular}
    }
\end{center}

\subsection{CartPole}
\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                               & evaluate\_max\_reward & evaluate\_rewards\_mean & evaluate\_rewards\_std \\
            2024-06-13\_17-34-57\_dqn\_cartpole & 10.0                  & 10.0                    & 0.0                    \\
            2024-06-14\_00-20-45\_dqn\_cartpole & 86.0                  & 86.0                    & 0.0                    \\
            2024-06-13\_21-08-24\_dqn\_cartpole & 92.0                  & 92.0                    & 0.0                    \\
            2024-06-14\_09-34-50\_dqn\_cartpole & 201.0                 & 201.0                   & 0.0                    \\
            2024-06-13\_18-59-17\_dqn\_cartpole & 86.0                  & 86.0                    & 0.0                    \\
            2024-06-14\_17-31-42\_dqn\_cartpole & 214.0                 & 214.0                   & 0.0                    \\
            2024-06-14\_18-54-27\_dqn\_cartpole & 9.0                   & 9.0                     & 0.0                    \\
            2024-06-14\_18-17-10\_dqn\_cartpole & 95.0                  & 95.0                    & 0.0                    \\
            2024-06-13\_18-42-33\_dqn\_cartpole & 9.0                   & 9.0                     & 0.0                    \\
            2024-06-13\_23-08-40\_dqn\_cartpole & 89.0                  & 89.0                    & 0.0                    \\
            2024-06-14\_16-42-26\_dqn\_cartpole & 119.0                 & 119.0                   & 0.0                    \\
            2024-06-15\_00-29-02\_dqn\_cartpole & 10.0                  & 10.0                    & 0.0                    \\
            2024-06-13\_18-50-05\_dqn\_cartpole & 336.0                 & 336.0                   & 0.0                    \\
            2024-06-14\_18-50-42\_dqn\_cartpole & 500.0                 & 500.0                   & 0.0                    \\
            2024-06-13\_19-11-27\_dqn\_cartpole & 88.0                  & 88.0                    & 0.0                    \\
            2024-06-14\_13-15-56\_dqn\_cartpole & 9.0                   & 9.0                     & 0.0                    \\
            2024-06-14\_15-38-10\_dqn\_cartpole & 214.0                 & 214.0                   & 0.0                    \\
            2024-06-13\_18-56-41\_dqn\_cartpole & 10.0                  & 10.0                    & 0.0                    \\
            2024-06-14\_11-09-14\_dqn\_cartpole & 255.0                 & 255.0                   & 0.0                    \\
            2024-06-13\_19-37-45\_dqn\_cartpole & 9.0                   & 9.0                     & 0.0                    \\
            2024-06-13\_21-45-52\_dqn\_cartpole & 230.0                 & 230.0                   & 0.0                    \\
            2024-06-13\_22-34-12\_dqn\_cartpole & 96.0                  & 96.0                    & 0.0                    \\
            2024-06-13\_20-39-12\_dqn\_cartpole & 14.0                  & 14.0                    & 0.0                    \\
            2024-06-14\_19-20-40\_dqn\_cartpole & 500.0                 & 500.0                   & 0.0                    \\
            2024-06-14\_18-05-51\_dqn\_cartpole & 97.0                  & 97.0                    & 0.0                    \\
            2024-06-14\_13-24-09\_dqn\_cartpole & 44.0                  & 44.0                    & 0.0                    \\
            2024-06-13\_23-49-30\_dqn\_cartpole & 92.0                  & 92.0                    & 0.0                    \\
            2024-06-14\_17-21-25\_dqn\_cartpole & 86.0                  & 86.0                    & 0.0                    \\
            2024-06-13\_22-09-48\_dqn\_cartpole & 90.0                  & 90.0                    & 0.0                    \\
            2024-06-13\_19-16-11\_dqn\_cartpole & 49.0                  & 49.0                    & 0.0                    \\
        \end{tabular}
    }
\end{center}

\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                               & hidden\_layers & units\_per\_layer        & activation\_per\_layer               \\
            2024-06-13\_17-34-57\_dqn\_cartpole & 4              & {[}512, 512, 512, 512{]} & {[}'relu', 'relu', 'relu', 'relu'{]} \\
            2024-06-14\_00-20-45\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_21-08-24\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_09-34-50\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_18-59-17\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_17-31-42\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_18-54-27\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_18-17-10\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_18-42-33\_dqn\_cartpole & 2              & {[}512, 512{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_23-08-40\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_16-42-26\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-15\_00-29-02\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_18-50-05\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_18-50-42\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_19-11-27\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_13-15-56\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_15-38-10\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_18-56-41\_dqn\_cartpole & 2              & {[}128, 128{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_11-09-14\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_19-37-45\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_21-45-52\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_22-34-12\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_20-39-12\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_19-20-40\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_18-05-51\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_13-24-09\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_23-49-30\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-14\_17-21-25\_dqn\_cartpole & 2              & {[}64, 64{]}             & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_22-09-48\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
            2024-06-13\_19-16-11\_dqn\_cartpole & 2              & {[}256, 256{]}           & {[}'relu', 'relu'{]}                 \\
        \end{tabular}
    }
\end{center}

\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                               & output\_layer\_activation & num\_episodes & learning\_rate \\
            2024-06-13\_17-34-57\_dqn\_cartpole & linear                    & 10000         & 0.01           \\
            2024-06-14\_00-20-45\_dqn\_cartpole & linear                    & 6000          & 0.001          \\
            2024-06-13\_21-08-24\_dqn\_cartpole & linear                    & 5000          & 0.001          \\
            2024-06-14\_09-34-50\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-13\_18-59-17\_dqn\_cartpole & linear                    & 3000          & 0.01           \\
            2024-06-14\_17-31-42\_dqn\_cartpole & linear                    & 6000          & 0.001          \\
            2024-06-14\_18-54-27\_dqn\_cartpole & sigmoid                   & 6000          & 0.005          \\
            2024-06-14\_18-17-10\_dqn\_cartpole & linear                    & 6000          & 0.005          \\
            2024-06-13\_18-42-33\_dqn\_cartpole & linear                    & 10000         & 0.01           \\
            2024-06-13\_23-08-40\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-14\_16-42-26\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-15\_00-29-02\_dqn\_cartpole & linear                    & 7000          & 0.001          \\
            2024-06-13\_18-50-05\_dqn\_cartpole & linear                    & 3000          & 0.01           \\
            2024-06-14\_18-50-42\_dqn\_cartpole & linear                    & 6000          & 0.005          \\
            2024-06-13\_19-11-27\_dqn\_cartpole & linear                    & 3000          & 0.005          \\
            2024-06-14\_13-15-56\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-14\_15-38-10\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-13\_18-56-41\_dqn\_cartpole & linear                    & 3000          & 0.01           \\
            2024-06-14\_11-09-14\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-13\_19-37-45\_dqn\_cartpole & linear                    & 6000          & 0.005          \\
            2024-06-13\_21-45-52\_dqn\_cartpole & linear                    & 5000          & 0.001          \\
            2024-06-13\_22-34-12\_dqn\_cartpole & linear                    & 5000          & 0.001          \\
            2024-06-13\_20-39-12\_dqn\_cartpole & linear                    & 5000          & 0.005          \\
            2024-06-14\_19-20-40\_dqn\_cartpole & linear                    & 6000          & 0.005          \\
            2024-06-14\_18-05-51\_dqn\_cartpole & linear                    & 6000          & 0.001          \\
            2024-06-14\_13-24-09\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-13\_23-49-30\_dqn\_cartpole & linear                    & 4000          & 0.001          \\
            2024-06-14\_17-21-25\_dqn\_cartpole & linear                    & 10000         & 0.001          \\
            2024-06-13\_22-09-48\_dqn\_cartpole & linear                    & 6000          & 0.001          \\
            2024-06-13\_19-16-11\_dqn\_cartpole & linear                    & 3000          & 0.01           \\
        \end{tabular}
    }
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                               & epsilon              & epsilon\_min & epsilon\_decay \\
            2024-06-13\_17-34-57\_dqn\_cartpole & 0.000993147795920851 & 0.001        & 0.99           \\
            2024-06-14\_00-20-45\_dqn\_cartpole & 0.004998338275642187 & 0.005        & 0.999          \\
            2024-06-13\_21-08-24\_dqn\_cartpole & 0.006721111959865607 & 0.005        & 0.999          \\
            2024-06-14\_09-34-50\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-13\_18-59-17\_dqn\_cartpole & 0.74080710775091     & 0.001        & 0.9999         \\
            2024-06-14\_17-31-42\_dqn\_cartpole & 0.5487951708942683   & 0.005        & 0.9999         \\
            2024-06-14\_18-54-27\_dqn\_cartpole & 0.004998338275642187 & 0.005        & 0.999          \\
            2024-06-14\_18-17-10\_dqn\_cartpole & 0.1652542546206636   & 0.005        & 0.9997         \\
            2024-06-13\_18-42-33\_dqn\_cartpole & 0.000993147795920851 & 0.001        & 0.99           \\
            2024-06-13\_23-08-40\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-14\_16-42-26\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-15\_00-29-02\_dqn\_cartpole & 0.004998338275642187 & 0.005        & 0.999          \\
            2024-06-13\_18-50-05\_dqn\_cartpole & 0.04971239399803625  & 0.001        & 0.999          \\
            2024-06-14\_18-50-42\_dqn\_cartpole & 0.01497353923933631  & 0.005        & 0.9993         \\
            2024-06-13\_19-11-27\_dqn\_cartpole & 0.04971239399803625  & 0.001        & 0.999          \\
            2024-06-14\_13-15-56\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-14\_15-38-10\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-13\_18-56-41\_dqn\_cartpole & 0.04971239399803625  & 0.001        & 0.999          \\
            2024-06-14\_11-09-14\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-13\_19-37-45\_dqn\_cartpole & 0.00247132211701599  & 0.001        & 0.999          \\
            2024-06-13\_21-45-52\_dqn\_cartpole & 0.006721111959865607 & 0.005        & 0.999          \\
            2024-06-13\_22-34-12\_dqn\_cartpole & 0.006721111959865607 & 0.005        & 0.999          \\
            2024-06-13\_20-39-12\_dqn\_cartpole & 0.006721111959865607 & 0.005        & 0.999          \\
            2024-06-14\_19-20-40\_dqn\_cartpole & 0.004998338275642187 & 0.005        & 0.999          \\
            2024-06-14\_18-05-51\_dqn\_cartpole & 0.04974972962361759  & 0.005        & 0.9995         \\
            2024-06-14\_13-24-09\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-13\_23-49-30\_dqn\_cartpole & 0.018279019827489446 & 0.005        & 0.999          \\
            2024-06-14\_17-21-25\_dqn\_cartpole & 0.004998338275642187 & 0.005        & 0.999          \\
            2024-06-13\_22-09-48\_dqn\_cartpole & 0.00247132211701599  & 0.001        & 0.999          \\
            2024-06-13\_19-16-11\_dqn\_cartpole & 0.22304647413401948  & 0.001        & 0.9995         \\
        \end{tabular}
    }
\end{center}

\begin{center}
    \resizebox{\textwidth}{!} {
        \begin{tabular}{llll}
            model                               & batch\_size & discount & update\_target\_every \\
            2024-06-13\_17-34-57\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-14\_00-20-45\_dqn\_cartpole & 128         & 0.9      & 40                    \\
            2024-06-13\_21-08-24\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-14\_09-34-50\_dqn\_cartpole & 128         & 0.9      & 30                    \\
            2024-06-13\_18-59-17\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-14\_17-31-42\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-14\_18-54-27\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-14\_18-17-10\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-13\_18-42-33\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-13\_23-08-40\_dqn\_cartpole & 128         & 0.9      & 40                    \\
            2024-06-14\_16-42-26\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-15\_00-29-02\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-13\_18-50-05\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-14\_18-50-42\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-13\_19-11-27\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-14\_13-15-56\_dqn\_cartpole & 128         & 0.99     & 30                    \\
            2024-06-14\_15-38-10\_dqn\_cartpole & 128         & 0.8      & 30                    \\
            2024-06-13\_18-56-41\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-14\_11-09-14\_dqn\_cartpole & 128         & 0.99     & 10                    \\
            2024-06-13\_19-37-45\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-13\_21-45-52\_dqn\_cartpole & 128         & 0.9      & 20                    \\
            2024-06-13\_22-34-12\_dqn\_cartpole & 128         & 0.9      & 20                    \\
            2024-06-13\_20-39-12\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-14\_19-20-40\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-14\_18-05-51\_dqn\_cartpole & 128         & 0.95     & 40                    \\
            2024-06-14\_13-24-09\_dqn\_cartpole & 128         & 0.99     & 40                    \\
            2024-06-13\_23-49-30\_dqn\_cartpole & 128         & 0.9      & 10                    \\
            2024-06-14\_17-21-25\_dqn\_cartpole & 128         & 0.8      & 30                    \\
            2024-06-13\_22-09-48\_dqn\_cartpole & 32          & 0.9      & 20                    \\
            2024-06-13\_19-16-11\_dqn\_cartpole & 32          & 0.9      & 20
        \end{tabular}
    }
\end{center}

\section{Discusión}
Se entrenaron múltiples modelos variando los hiperparámetros como la cantidad de epochs, la cantidad de capas y la cantidad de neuronas en cada capa. La decisión del mejor modelo se tomó a partir del valor mas alto en la recompensa de evaluación.

\subsection{Mountain}
\input{discussion_images_mountain.tex}

\subsection{CartPole}
\input{discussion_images_cartpole.tex}

\section{Conclusión}
Concluimos que las redes neuronales pueden ser una herramienta eficaz para aproximar la solución de la ecuación de movimiento de un péndulo simple. Sin embargo, es importante considerar la complejidad del modelo y la calidad de los datos de entrada para obtener resultados precisos.

\end{document}
